# AGENTS.md

This file provides guidance to agents when working with code in this repository.

## 项目文档规则（仅非显而易见部分）

### 项目理解要点
- **项目本质**：这是一个VSCode扩展，用于项目级别的文档翻译，不是独立的Web应用
- **核心功能**：批量翻译项目文件，支持多种文件格式和编程语言
- **特殊机制**：AI可以通过返回特定UUID来指示"无需翻译"，系统会直接复制原文件

### 文件组织结构
- `src/` 包含VSCode扩展代码，不是Web应用的源代码（反直觉）
- `sample/` 包含测试用的示例文件和翻译配置
- `.translation-cache/` 存储翻译历史记录，按语言分类
- `l10n/` 用于VSCode扩展的本地化，与翻译功能无关

### 配置系统特点
- 支持多个翻译供应商（DeepSeek、Grok等）
- API密钥可通过环境变量注入（如`DEEPSEEK_API_KEY`）
- 系统提示词硬编码在代码中，强调格式保持
- 支持复杂的文件匹配和忽略规则

### 翻译决策逻辑
- 基于文件哈希、时间间隔和配置的智能缓存
- 5分钟内的翻译决策会被缓存避免重复检查
- 会话级别的"无需翻译"缓存提高效率
- 支持front matter跳过机制

### 关键技术细节
- 使用OpenAI兼容的API，支持流式和标准模式
- 大文件自动分块处理，基于token限制
- 二进制文件检测和直接复制机制
- 严格的错误处理和用户取消支持

### 测试和调试
- 使用`simpleRunner.ts`提供无需VSCode GUI的测试方式
- 测试文件必须编译到`out/test/`目录
- 支持详细的调试日志记录
- 失败文件路径会被记录用于后续分析

### 扩展特定信息
- 通过VSCode命令面板访问所有功能
- 支持文件和文件夹级别的右键菜单操作
- 集成VSCode的本地化系统支持多语言界面
- 扩展状态通过状态栏显示（暂停/恢复/停止）